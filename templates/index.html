<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Market Vision Pro | AI Analytics</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@600;700&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
</head>
<body>
    <div class="theme-toggle" onclick="toggleTheme()">
        <i class="fas fa-moon"></i>
    </div>

    <div class="container">
        <header class="analytics-header">
            <h1 class="gradient-text">Market Vision Pro</h1>
            <div class="ai-status">
                <span class="pulse-dot"></span>
                <span>AI Analysis Engine Active</span>
            </div>
        </header>

        <form id="predictionForm" class="neon-form">
            <div class="form-grid">
                <!-- Product Details -->
                <div class="form-section">
                    <h2><i class="fas fa-box-open"></i> Product Specifications</h2>
                    <div class="form-group">
                        <input type="number" step="0.01" name="Price" min="0" required placeholder=" ">
                        <label class="floating-label">Price ($)</label>
                    </div>
                    <div class="form-group">
                        <input type="number" step="0.01" name="Discount" min="0" max="100" required placeholder=" ">
                        <label class="floating-label">Discount (%)</label>
                    </div>
                    <div class="form-group">
                        <input type="number" step="0.01" name="Tax Rate" min="0" required placeholder=" ">
                        <label class="floating-label">Tax Rate (%)</label>
                    </div>
                </div>

                <!-- Inventory Details -->
                <div class="form-section">
                    <h2><i class="fas fa-warehouse"></i> Inventory Metrics</h2>
                    <div class="form-group">
                        <input type="number" name="Stock Level" min="0" required placeholder=" ">
                        <label class="floating-label">Stock Level</label>
                    </div>
                    <div class="form-group">
                        <input type="number" step="0.01" name="Shipping Cost" min="0" required placeholder=" ">
                        <label class="floating-label">Shipping Cost ($)</label>
                    </div>
                    <div class="form-group">
                        <input type="number" step="0.01" name="Return Rate" min="0" max="100" required placeholder=" ">
                        <label class="floating-label">Return Rate (%)</label>
                    </div>
                </div>
            </div>

            <div class="form-grid">
                <!-- Product Profile -->
                <div class="form-section">
                    <h2><i class="fas fa-tags"></i> Product Profile</h2>
                    <div class="form-group">
                        <select name="Category" required>
                            <option value=""></option>
                            <option value="Apparel">Apparel</option>
                            <option value="Books">Books</option>
                            <option value="Electronics">Electronics</option>
                            <option value="Footwear">Footwear</option>
                            <option value="Home Appliances">Home Appliances</option>
                        </select>
                        <label class="floating-label">Product Category</label>
                    </div>
                    <div class="form-group">
                        <select name="Seasonality" required>
                            <option value=""></option>
                            <option value="No">No</option>
                            <option value="Yes">Yes</option>
                        </select>
                        <label class="floating-label">Seasonal Product</label>
                    </div>
                </div>

                <!-- Customer Profile -->
                <div class="form-section">
                    <h2><i class="fas fa-user-group"></i> Customer Profile</h2>
                    <div class="form-group">
                        <select name="Customer Age Group" required>
                            <option value=""></option>
                            <option value="18-24">18-24</option>
                            <option value="25-34">25-34</option>
                            <option value="35-44">35-44</option>
                            <option value="45-54">45-54</option>
                            <option value="55+">55+</option>
                        </select>
                        <label class="floating-label">Age Group</label>
                    </div>
                    <div class="form-group">
                        <select name="Customer Location" required>
                            <option value=""></option>
                            <option value="Berlin, Germany">Berlin, Germany</option>
                            <option value="Cape Town, South Africa">Cape Town, South Africa</option>
                            <option value="Chicago, USA">Chicago, USA</option>
                            <option value="Dubai, UAE">Dubai, UAE</option>
                            <option value="Houston, USA">Houston, USA</option>
                            <option value="London, UK">London, UK</option>
                            <option value="Los Angeles, USA">Los Angeles, USA</option>
                            <option value="Mumbai, India">Mumbai, India</option>
                            <option value="New York, USA">New York, USA</option>
                            <option value="Paris, France">Paris, France</option>
                            <option value="Phoenix, USA">Phoenix, USA</option>
                            <option value="Singapore">Singapore</option>
                            <option value="Sydney, Australia">Sydney, Australia</option>
                            <option value="Tokyo, Japan">Tokyo, Japan</option>
                            <option value="Toronto, Canada">Toronto, Canada</option>
                        </select>
                        <label class="floating-label">Location</label>
                    </div>
                    <div class="form-group">
                        <select name="Customer Gender" required>
                            <option value=""></option>
                            <option value="Female">Female</option>
                            <option value="Male">Male</option>
                            <option value="Non-Binary">Non-Binary</option>
                        </select>
                        <label class="floating-label">Gender</label>
                    </div>
                </div>
            </div>

            <!-- Shipping Details -->
            <div class="form-section">
                <h2><i class="fas fa-shipping-fast"></i> Shipping Details</h2>
                <div class="form-group">
                    <select name="Shipping Method" required>
                        <option value=""></option>
                        <option value="Standard">Standard</option>
                        <option value="Express">Express</option>
                        <option value="Overnight">Overnight</option>
                    </select>
                    <label class="floating-label">Shipping Method</label>
                </div>
            </div>

            <button type="submit" class="predict-button">
                <i class="fas fa-brain-circuit"></i>
                <span>Generate AI Insights</span>
                <div class="button-loader">
                    <div class="bounce-dot"></div>
                    <div class="bounce-dot"></div>
                    <div class="bounce-dot"></div>
                </div>
            </button>
        </form>

        <div id="result" class="hidden">
            <div class="result-header">
                <h3>Strategic Market Analysis</h3>
                <div class="analysis-meta">
                    <span class="timestamp"></span>
                    <div class="result-actions">
                        <button class="icon-button" onclick="saveReport()">
                            <i class="fas fa-download"></i>
                        </button>
                        <button class="icon-button" onclick="window.print()">
                            <i class="fas fa-print"></i>
                        </button>
                    </div>
                </div>
            </div>
            
            <div class="result-grid">
                <div class="score-container">
                    <div class="radial-progress" data-progress="0" style="--progress: 0%">
                        <div class="sparkles"></div>
                    </div>
                    <div class="score-labels">
                        <span class="score-value">Market Fitness</span>
                        <span class="score-comparison">vs Industry Benchmark</span>
                    </div>
                </div>

                <div class="insight-stack">
                    <div class="insight-card">
                        <div class="card-header">
                            <i class="fas fa-rocket"></i>
                            <h4>Optimization Strategy</h4>
                        </div>
                        <p id="recommendationText" class="glow-text"></p>
                    </div>
                    
                    <div class="insight-card">
                        <div class="card-header">
                            <i class="fas fa-sitemap"></i>
                            <h4>Key Performance Drivers</h4>
                        </div>
                        <ul id="keyFactors"></ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Theme Toggle
        function toggleTheme() {
            const body = document.body;
            const themeIcon = document.querySelector('.theme-toggle i');
            
            body.classList.add('theme-transition');
            setTimeout(() => body.classList.remove('theme-transition'), 500);
            
            body.setAttribute('data-theme', 
                body.getAttribute('data-theme') === 'dark' ? 'light' : 'dark'
            );
            
            themeIcon.className = body.getAttribute('data-theme') === 'dark' 
                ? 'fas fa-sun' 
                : 'fas fa-moon';
        }

        // Radial Progress Animation
        function updateRadial(percentage) {
            const radial = document.querySelector('.radial-progress');
            let progress = 0;
            
            const animation = setInterval(() => {
                progress++;
                radial.style.setProperty('--progress', `${progress}%`);
                radial.setAttribute('data-progress', progress);
                
                if(progress >= percentage) {
                    clearInterval(animation);
                    if(percentage > 75) addSparkles();
                }
            }, 20);
        }

        // Form Submission
        document.getElementById('predictionForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const button = e.target.querySelector('button');
            
            try {
                button.classList.add('loading');
                const response = await fetch('/predict', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
                    body: new URLSearchParams(new FormData(e.target))
                });

                const data = await response.json();
                
                if(data.status === 'success') {
                    button.classList.remove('loading');
                    showResults(data);
                }
            } catch (error) {
                alert('Analysis Error: Please check inputs');
                button.classList.remove('loading');
            }
        });

        function showResults(data) {
            updateRadial(data.probability);
            document.getElementById('recommendationText').innerHTML = 
                data.probability > 50 ?
                `<span class="success-pulse">üöÄ Strong Market Fit</span> (${data.probability}%)` :
                `<span class="warning-pulse">‚ö†Ô∏è Needs Optimization</span> (${data.probability}%)`;

            document.getElementById('result').classList.remove('hidden');
            document.querySelector('.timestamp').textContent = new Date().toLocaleString();
        }

        function addSparkles() {
            const sparkles = document.querySelector('.sparkles');
            sparkles.innerHTML = Array(10).fill().map(() => 
                `<div class="sparkle" style="
                    --x: ${Math.random() * 100}%;
                    --y: ${Math.random() * 100}%;
                    --delay: ${Math.random() * 1}s;
                "></div>`
            ).join('');
        }
    </script>
</body>
</html>